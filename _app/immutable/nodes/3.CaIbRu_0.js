import{d as tt,c as Je,a as f,f as _,s as g,e as Ve,t as Ge}from"../chunks/B51cwJvt.js";import{i as Te}from"../chunks/DB0iArIQ.js";import{I as Qe,as as rt,e as We,ao as at,i as st,aC as it,aD as ot,a6 as Ee,av as nt,p as He,g as Ne,h as Ke,a as Xe,q as p,j as ve,o as P,m as E,c as i,s as d,f as n,r as s,k as t,t as D,$ as lt,aE as dt}from"../chunks/I7kW3HN8.js";import{i as y}from"../chunks/BmRqm3E_.js";import{e as vt}from"../chunks/De7vBO-T.js";import{h as ct}from"../chunks/BzyVKUbO.js";import{s as ke,r as ut}from"../chunks/Qgj7xOVc.js";import{a as ft,M as pt,s as Se,t as $e}from"../chunks/D8F7ty4a.js";import{c as xt,b as _t}from"../chunks/sfh6b0eg.js";import{s as Ye,a as X}from"../chunks/DjaJJ-dN.js";import{a as Pe,u as Ze,c as bt,p as gt}from"../chunks/iLhF7f-Y.js";import{c as mt}from"../chunks/ed8_NNNN.js";import{p as qe}from"../chunks/D51ArLJV.js";function ht(o,c,m,b){var w=o.__style;if(Qe||w!==c){var x=ft(c);(!Qe||x!==o.getAttribute("style"))&&(x==null?o.removeAttribute("style"):o.style.cssText=x),o.__style=c}return b}function et(o,c,m=!1){if(o.multiple){if(c==null)return;if(!st(c))return it();for(var b of o.options)b.selected=c.includes(ce(b));return}for(b of o.options){var w=ce(b);if(ot(w,c)){b.selected=!0;return}}(!m||c!==void 0)&&(o.selectedIndex=-1)}function yt(o){var c=new MutationObserver(()=>{et(o,o.__value)});c.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),at(()=>{c.disconnect()})}function wt(o,c,m=c){var b=new WeakSet,w=!0;rt(o,"change",x=>{var h=x?"[selected]":":checked",$;if(o.multiple)$=[].map.call(o.querySelectorAll(h),ce);else{var I=o.querySelector(h)??o.querySelector("option:not([disabled])");$=I&&ce(I)}m($),Ee!==null&&b.add(Ee)}),We(()=>{var x=c();if(o===document.activeElement){var h=nt??Ee;if(b.has(h))return}if(et(o,x,w),w&&x===void 0){var $=o.querySelector(":checked");$!==null&&(x=ce($),m(x))}o.__value=x,w=!1}),yt(o)}function ce(o){return"__value"in o?o.__value:o.value}function $t(o){return function(...c){var m=c[0];return m.stopPropagation(),o==null?void 0:o.apply(this,c)}}var Pt=_('<div class="absolute -bottom-2 md:right-0 right-8 bg-amber-500 text-slate-900 font-bold px-2 py-0.5 rounded text-xs border border-white/20 shadow-lg"> </div>'),kt=_('<p class="text-xs text-slate-500 mt-1 uppercase tracking-widest"> </p>'),Ft=_('<span class="text-[9px] text-slate-600">(Est)</span>'),Ct=_('<span class="text-[9px] text-slate-600">(Est)</span>'),jt=_('<div class="px-3 py-1 rounded bg-green-500/20 text-green-400 text-xs font-bold border border-green-500/30">EN PROPIEDAD</div>'),Mt=_('<div class="text-xs text-green-400 font-medium">Puedes pagarlo</div>'),It=_('<div class="text-xs text-red-400 font-medium"> </div>'),Lt=_('<button class="flex-1 bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/30 py-3 rounded-lg font-bold transition-all"> </button>'),Ot=_('<button class="flex-1 bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white shadow-lg shadow-green-900/20 py-3 rounded-lg font-bold transition-all disabled:opacity-50 disabled:cursor-not-allowed">Fichar Jugador</button>'),Rt=_('<div class="space-y-6"><div class="flex flex-col items-center text-center"><div class="relative mb-4"><img class="w-32 h-32 rounded-full border-4 border-amber-500/20 shadow-2xl object-cover"/> <!> <div class="absolute -bottom-2 left-8 md:left-0 bg-slate-800 text-white font-mono text-xs px-2 py-0.5 rounded border border-white/10"> </div></div> <h3 class="text-2xl font-bold font-serif text-white"> </h3> <p class="text-slate-400 font-mono text-sm"> </p> <!></div> <div class="grid grid-cols-3 gap-2"><div class="bg-slate-800/50 p-3 rounded-lg border border-white/5 text-center flex flex-col items-center justify-center"><div class="text-2xl mb-1">‚ôüÔ∏è</div> <div class="text-[10px] text-slate-500 uppercase tracking-wider font-bold mb-1">Classic</div> <div> </div></div> <div class="bg-slate-800/50 p-3 rounded-lg border border-white/5 text-center flex flex-col items-center justify-center"><div class="text-2xl mb-1">üêá</div> <div class="text-[10px] text-slate-500 uppercase tracking-wider font-bold mb-1">Rapid</div> <div> </div> <!></div> <div class="bg-slate-800/50 p-3 rounded-lg border border-white/5 text-center flex flex-col items-center justify-center"><div class="text-2xl mb-1">‚ö°</div> <div class="text-[10px] text-slate-500 uppercase tracking-wider font-bold mb-1">Blitz</div> <div> </div> <!></div></div> <div class="bg-slate-900/50 p-4 rounded-xl border border-white/5 flex justify-between items-center"><div><div class="text-xs text-slate-400 uppercase tracking-wider mb-1">Valor de Mercado</div> <div class="text-3xl font-bold text-white font-mono"> </div></div> <div class="text-right"><!></div></div> <div class="flex gap-3"><!></div></div>');function Dt(o,c){He(c,!1);const m=()=>X(Pe,"$ownedPlayerIds",w),b=()=>X(Ze,"$user",w),[w,x]=Ye(),h=E(),$=E();let I=qe(c,"isOpen",8,!1),e=qe(c,"player",8,null),j=qe(c,"onClose",8);const L=mt();function O(R){return`${(R/1e6).toFixed(1)}M`}function ue(){e()&&(L("buy",e()),fe(),j()())}function Fe(){e()&&(L("sell",e()),j()())}function fe(){xt({particleCount:100,spread:70,origin:{y:.6},colors:["#FFD700","#FFA500","#FFFFFF"]})}function Y(R){return R>=2800?"text-purple-400":R>=2700?"text-red-400":R>=2600?"text-amber-400":"text-green-400"}Ne(()=>(p(e()),m()),()=>{P(h,e()?m().includes(e().id):!1)}),Ne(()=>(p(e()),b()),()=>{P($,e()?b().budget>=e().price:!1)}),Ke(),Te(),pt(o,{get isOpen(){return I()},title:"Ficha de Jugador",get onClose(){return j()},children:(R,Ue)=>{var pe=Je(),xe=ve(pe);{var Z=S=>{var q=Rt(),J=i(q),N=i(J),U=i(N),ee=d(U,2);{var Ce=a=>{var v=Pt(),F=i(v,!0);s(v),D(()=>g(F,(p(e()),n(()=>e().title)))),f(a,v)};y(ee,a=>{p(e()),n(()=>e().title)&&a(Ce)})}var _e=d(ee,2),je=i(_e);s(_e),s(N);var te=d(N,2),r=i(te,!0);s(te);var u=d(te,2),re=i(u);s(u);var be=d(u,2);{var ge=a=>{var v=kt(),F=i(v,!0);s(v),D(()=>g(F,(p(e()),n(()=>e().country)))),f(a,v)};y(be,a=>{p(e()),n(()=>e().country)&&a(ge)})}s(J);var ae=d(J,2),se=i(ae),k=d(i(se),4),l=i(k,!0);s(k),s(se);var z=d(se,2),A=d(i(z),4),Me=i(A,!0);s(A);var ie=d(A,2);{var me=a=>{var v=Ft();f(a,v)};y(ie,a=>{p(e()),n(()=>!e().ratingRapid)&&a(me)})}s(z);var W=d(z,2),V=d(i(W),4),oe=i(V,!0);s(V);var Ie=d(V,2);{var he=a=>{var v=Ct();f(a,v)};y(Ie,a=>{p(e()),n(()=>!e().ratingBlitz)&&a(he)})}s(W),s(ae);var ne=d(ae,2),G=i(ne),le=d(i(G),2),Le=i(le,!0);s(le),s(G);var H=d(G,2),de=i(H);{var Oe=a=>{var v=jt();f(a,v)},ye=a=>{var v=Je(),F=ve(v);{var Q=C=>{var T=Mt();f(C,T)},B=C=>{var T=It(),ze=i(T);s(T),D(Ae=>g(ze,`Insuficiente (-${Ae??""})`),[()=>(p(e()),b(),n(()=>O(e().price-b().budget)))]),f(C,T)};y(F,C=>{t($)?C(Q):C(B,!1)},!0)}f(a,v)};y(de,a=>{t(h)?a(Oe):a(ye,!1)})}s(H),s(ne);var we=d(ne,2),Re=i(we);{var De=a=>{var v=Lt();v.__click=Fe;var F=i(v);s(v),D(Q=>g(F,`Vender (${Q??""})`),[()=>(p(e()),n(()=>O(e().price*.8)))]),f(a,v)},M=a=>{var v=Ot();v.__click=ue,D(()=>v.disabled=!t($)),f(a,v)};y(Re,a=>{t(h)?a(De):a(M,!1)})}s(we),s(q),D((a,v,F,Q)=>{ke(U,"src",(p(e()),n(()=>e().photoUrl||`https://ui-avatars.com/api/?name=${e().name}&background=random`))),ke(U,"alt",(p(e()),n(()=>e().name))),g(je,`Rank #${p(e()),n(()=>e().position)??""}`),g(r,(p(e()),n(()=>e().name))),g(re,`@${p(e()),n(()=>e().username)??""}`),Se(k,1,a),g(l,(p(e()),n(()=>e().rating))),Se(A,1,v),g(Me,(p(e()),n(()=>e().ratingRapid||"-"))),Se(V,1,F),g(oe,(p(e()),n(()=>e().ratingBlitz||"-"))),g(Le,Q)},[()=>(p(e()),n(()=>`text-lg font-bold font-mono ${Y(e().rating)}`)),()=>(p(e()),n(()=>`text-lg font-bold font-mono ${Y(e().ratingRapid||e().rating-100)}`)),()=>(p(e()),n(()=>`text-lg font-bold font-mono ${Y(e().ratingBlitz||e().rating+50)}`)),()=>(p(e()),n(()=>O(e().price)))]),f(S,q)};y(xe,S=>{e()&&S(Z)})}f(R,pe)},$$slots:{default:!0}}),Xe(),x()}tt(["click"]);var zt=_('<div class="text-center py-20"><div class="text-6xl mb-6 mx-auto w-fit animate-pulse text-primary">‚ôî</div> <p class="text-slate-400 text-lg">Cargando jugadores desde Lichess...</p></div>'),At=_('<span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-success/20 text-success border border-success/30">‚úì Fichado</span>'),Bt=_('<span class="animate-spin inline-block">‚Üª</span>'),Et=_('<button class="btn-primary text-xs px-4 py-1.5 min-w-[90px] shadow-lg shadow-green-900/20"><!></button>'),St=_('<tr class="hover:bg-white/5 transition-colors group cursor-pointer"><td class="px-4 py-3 text-sm text-slate-500 font-mono"> </td><td class="px-4 py-3"><div class="flex items-center gap-3"><img class="w-10 h-10 rounded-full object-cover border border-white/10 group-hover:border-primary/50 transition-colors" loading="lazy"/> <div><div class="font-medium text-white group-hover:text-primary transition-colors"> </div> <div class="text-xs text-slate-500"> </div></div></div></td><td class="px-4 py-3"><span class="font-mono font-bold text-slate-300 bg-slate-800/50 px-2 py-1 rounded text-xs"> </span></td><td class="px-4 py-3"><span class="font-bold"> </span></td><td class="px-4 py-3 text-right"><!></td></tr>'),qt=_('<div class="text-center py-20"><p class="text-slate-500">No se encontraron jugadores</p></div>'),Jt=_('<div class="card overflow-hidden"><table class="w-full"><thead class="bg-slate-900/50 border-b border-white/5"><tr><th class="px-4 py-4 text-left text-xs font-bold uppercase tracking-wider text-slate-400">#</th><th class="px-4 py-4 text-left text-xs font-bold uppercase tracking-wider text-slate-400">Jugador</th><th class="px-4 py-4 text-left text-xs font-bold uppercase tracking-wider text-slate-400">Rating</th><th class="px-4 py-4 text-left text-xs font-bold uppercase tracking-wider text-slate-400">Precio</th><th class="px-4 py-4 text-right text-xs font-bold uppercase tracking-wider text-slate-400">Acci√≥n</th></tr></thead><tbody class="divide-y divide-white/5"></tbody></table></div> <!>',1),Nt=_('<div class="space-y-6"><div><h1 class="text-3xl font-bold text-white mb-2">Mercado de Jugadores</h1> <p class="text-sm text-slate-400">Ficha a jugadores del top 500 de ajedrez cl√°sico de Lichess</p></div> <div class="flex gap-4"><input type="text" placeholder="Buscar jugador..." class="input flex-1"/> <select class="input w-48 cursor-pointer"><option>Por Ranking</option><option>Por Precio</option><option>Por Nombre</option></select></div> <!></div> <!>',1);function rr(o,c){He(c,!1);const m=()=>X(bt,"$availablePlayers",h),b=()=>X(Pe,"$ownedPlayerIds",h),w=()=>X(gt,"$playersLoading",h),x=()=>X(Ze,"$user",h),[h,$]=Ye(),I=E();let e=E(""),j=E("position"),L=E(null),O=E(!1),ue=E(null);function Fe(r){return b().includes(r)}function fe(r){P(L,r.id),P(O,!1);const u=Pe.buyPlayer(r.id,r.price);u.success?$e.success(u.message):$e.error(u.message),P(L,null)}function Y(r){const u=Pe.sellPlayer(r.id);u.success?$e.success(u.message):$e.error(u.message)}function R(r){P(ue,r),P(O,!0)}function Ue(r){return`${(r/1e6).toFixed(0)}M`}function pe(r,u){return r>u?"rgb(239, 83, 80)":r>u*.7?"rgb(255, 183, 77)":"rgb(102, 187, 106)"}Ne(()=>(m(),t(e),t(j)),()=>{P(I,m().filter(r=>r.name.toLowerCase().includes(t(e).toLowerCase())||r.username.toLowerCase().includes(t(e).toLowerCase())).sort((r,u)=>t(j)==="position"?r.position-u.position:t(j)==="price"?u.price-r.price:r.name.localeCompare(u.name)))}),Ke(),Te();var xe=Nt();ct("gzmktl",r=>{We(()=>{lt.title="Mercado - Grandmaster Fantasy"})});var Z=ve(xe),S=d(i(Z),2),q=i(S);ut(q);var J=d(q,2);D(()=>{t(j),dt(()=>{})});var N=i(J);N.value=N.__value="position";var U=d(N);U.value=U.__value="price";var ee=d(U);ee.value=ee.__value="name",s(J),s(S);var Ce=d(S,2);{var _e=r=>{var u=zt();f(r,u)},je=r=>{var u=Jt(),re=ve(u),be=i(re),ge=d(i(be));vt(ge,5,()=>t(I),k=>k.id,(k,l)=>{var z=St(),A=i(z),Me=i(A,!0);s(A);var ie=d(A),me=i(ie),W=i(me),V=d(W,2),oe=i(V),Ie=i(oe,!0);s(oe);var he=d(oe,2),ne=i(he);s(he),s(V),s(me),s(ie);var G=d(ie),le=i(G),Le=i(le,!0);s(le),s(G);var H=d(G),de=i(H),Oe=i(de,!0);s(de),s(H);var ye=d(H),we=i(ye);{var Re=M=>{var a=At();f(M,a)},De=M=>{var a=Et(),v=i(a);{var F=B=>{var C=Bt();f(B,C)},Q=B=>{var C=Je(),T=ve(C);{var ze=K=>{var Be=Ge("Sin saldo");f(K,Be)},Ae=K=>{var Be=Ge("Fichar");f(K,Be)};y(T,K=>{x(),t(l),n(()=>x().budget<t(l).price)?K(ze):K(Ae,!1)},!0)}f(B,C)};y(v,B=>{t(L),t(l),n(()=>t(L)===t(l).id)?B(F):B(Q,!1)})}s(a),D(()=>a.disabled=(t(L),t(l),x(),n(()=>t(L)===t(l).id||x().budget<t(l).price))),Ve("click",a,$t(()=>fe(t(l)))),f(M,a)};y(we,M=>{t(l),n(()=>Fe(t(l).id))?M(Re):M(De,!1)})}s(ye),s(z),D((M,a)=>{g(Me,(t(l),n(()=>t(l).position))),ke(W,"src",(t(l),n(()=>t(l).photoUrl||`https://ui-avatars.com/api/?name=${t(l).name}&background=random`))),ke(W,"alt",(t(l),n(()=>t(l).name))),g(Ie,(t(l),n(()=>t(l).name))),g(ne,`@${t(l),n(()=>t(l).username)??""}`),g(Le,(t(l),n(()=>t(l).rating))),ht(de,`color: ${M??""}`),g(Oe,a)},[()=>(t(l),x(),n(()=>pe(t(l).price,x().budget))),()=>(t(l),n(()=>Ue(t(l).price)))]),Ve("click",z,()=>R(t(l))),f(k,z)}),s(ge),s(be),s(re);var ae=d(re,2);{var se=k=>{var l=qt();f(k,l)};y(ae,k=>{t(I),n(()=>t(I).length===0)&&k(se)})}f(r,u)};y(Ce,r=>{w()?r(_e):r(je,!1)})}s(Z);var te=d(Z,2);Dt(te,{get player(){return t(ue)},onClose:()=>P(O,!1),get isOpen(){return t(O)},set isOpen(r){P(O,r)},$$events:{buy:r=>fe(r.detail),sell:r=>Y(r.detail)},$$legacy:!0}),_t(q,()=>t(e),r=>P(e,r)),wt(J,()=>t(j),r=>P(j,r)),f(o,xe),Xe(),$()}export{rr as component};
